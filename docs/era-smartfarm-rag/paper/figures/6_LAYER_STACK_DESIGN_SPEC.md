# ERA-SmartFarm-RAG 3-Pipeline ì•„í‚¤í…ì²˜ Figure ë””ìì¸ ëª…ì„¸ì„œ

> **ëª©ì **: ë””ìì´ë„ˆê°€ ì´ ë¬¸ì„œë§Œ ë³´ê³  ë°”ë¡œ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ Figureë¥¼ ê·¸ë¦´ ìˆ˜ ìˆë„ë¡ ì‘ì„±
> 
> **ì„¤ê³„ ì² í•™**: ìˆ˜í‰ ë°ì´í„° í”Œë¡œìš° + ì—£ì§€ ë””ë°”ì´ìŠ¤ ê²½ê³„ ë°•ìŠ¤ë¡œ "ì™„ì „í•œ ì˜¨ë””ë°”ì´ìŠ¤ RAG" ë©”ì‹œì§€ ì „ë‹¬

---

## 1. í•œëˆˆì— ë³´ê¸°

### 1.1 í•µì‹¬ ì»¨ì…‰

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  Edge Device (8GB RAM, Offline Capable)                                              â”ƒ
â”ƒ                                                                                       â”ƒ
â”ƒ  (A) Ingestion Pipeline â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”ƒ
â”ƒ      Data Sources â†’ Text Extraction â†’ Embedding â†’ Index & Graph Build                â”ƒ
â”ƒ                                                          â”‚                            â”ƒ
â”ƒ                                                          â–¼                            â”ƒ
â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”ƒ
â”ƒ  â”‚  Knowledge Store: [Dense] [Sparse] [Graph] [Ontology]                           â”‚  â”ƒ
â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”ƒ
â”ƒ  â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”  â”ƒ
â”ƒ    Cache Layer: [Query Cache] [Embedding Cache] [Response Cache]                      â”ƒ
â”ƒ  â”” â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”˜  â”ƒ
â”ƒ                                                          â”‚                            â”ƒ
â”ƒ  (B) Retrieval Pipeline â­ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”ƒ
â”ƒ      Query Analysis â†’ 3-Channel Search â†’ Context Shaping                              â”ƒ
â”ƒ                                                          â”‚                            â”ƒ
â”ƒ  (C) Generation Pipeline â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”ƒ
â”ƒ      Prompt Build â†’ LLM â†’ Response (+ Fallback Chain)                                 â”ƒ
â”ƒ                                                                                       â”ƒ
â”ƒ  â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”  â”ƒ
â”ƒ    Monitoring: [Query Latency] [Cache Hit Rate] [Fallback Usage]                      â”ƒ
â”ƒ  â”” â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”˜  â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
```

### 1.2 ì„¤ê³„ ì›ì¹™

| ì›ì¹™ | ì„¤ëª… | ì‹œê°ì  í‘œí˜„ |
|------|------|------------|
| **ì—£ì§€ ê²½ê³„ ê°•ì¡°** | ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ë””ë°”ì´ìŠ¤ ë‚´ë¶€ì—ì„œ ë™ì‘ | ë‘êº¼ìš´ ì™¸ê³½ ë°•ìŠ¤ |
| **ìˆ˜í‰ ë°ì´í„° í”Œë¡œìš°** | ì™¼ìª½â†’ì˜¤ë¥¸ìª½ íŒŒì´í”„ë¼ì¸ íë¦„ | í™”ì‚´í‘œ ë°©í–¥ í†µì¼ |
| **3-Pipeline ë¶„ë¦¬** | Ingestion / Retrieval / Generation ëª…í™• êµ¬ë¶„ | ì„¹ì…˜ë³„ ë°°ê²½ìƒ‰ |
| **í•µì‹¬ ê¸°ì—¬ ê°•ì¡°** | 3ì±„ë„ ê²€ìƒ‰ + Context Shaping | â­ ë§ˆì»¤ + ê°•ì¡° í…Œë‘ë¦¬ |
| **ë³´ì¡° ë ˆì´ì–´ êµ¬ë¶„** | Cache, Monitoringì€ í•µì‹¬ íŒŒì´í”„ë¼ì¸ ì™¸ë¶€ | ì ì„  ë°•ìŠ¤ |

---

## 2. ì „ì²´ ë ˆì´ì•„ì›ƒ (ìƒì„¸)

### 2.1 Full Version (ë…¼ë¬¸ ë³¸ë¬¸ìš©)

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                                                                                                         â”ƒ
â”ƒ   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”ƒ
â”ƒ   â•‘  Edge Device Environment                                            8GB RAM â”‚ Q4_K_M â”‚ Offline  â•‘   â”ƒ
â”ƒ   â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£   â”ƒ
â”ƒ   â•‘                                                                                                 â•‘   â”ƒ
â”ƒ   â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘   â”ƒ
â”ƒ   â•‘  â”‚ (A) Knowledge Ingestion Pipeline                                       [Offline Build]   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                                                           â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚    Data Sources    â”‚  â”‚ Text Extraction â”‚  â”‚Embedding â”‚  â”‚ Index & Graph Build     â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ â€¢ Local Files      â”‚â”€â–¶â”‚ â€¢ PDF/HWP Parse â”‚â”€â–¶â”‚          â”‚â”€â–¶â”‚ â€¢ Dense (FAISS)         â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚   (PDF/HWP/TXT)    â”‚  â”‚ â€¢ OCR Fallback  â”‚  â”‚          â”‚  â”‚ â€¢ Sparse (TF-IDF)       â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ â€¢ HuggingFace DS   â”‚  â”‚  (multi-backend)â”‚  â”‚          â”‚  â”‚ â€¢ Causal Graph Build    â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                             â”‚  â”‚ Causal Role       â”‚  â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                             â”‚  â”‚ Detection         â”‚  â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                             â”‚  â”‚ cause/effect/     â”‚  â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                             â”‚  â”‚ solution          â”‚  â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘   â”ƒ
â”ƒ   â•‘                                                                              â”‚                  â•‘   â”ƒ
â”ƒ   â•‘                                                                              â–¼                  â•‘   â”ƒ
â”ƒ   â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  Knowledge Store                                                                          â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                                                           â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ Dense Index â”‚  â”‚Sparse Index â”‚  â”‚    Causal Graph      â”‚  â”‚   Domain Ontology      â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ (FAISS)     â”‚  â”‚ (TF-IDF)    â”‚  â”‚  â”Œâ”€â”€â”€â”     â”Œâ”€â”€â”€â”     â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚  â”‚ C â”‚â”€â”€â”€â”€â–¶â”‚ E â”‚     â”‚  â”‚ â”‚crop â”‚ env â”‚nutrientâ”‚ â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚  â””â”€â”€â”€â”˜     â””â”€â”¬â”€â”˜     â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚   causes     â”‚       â”‚  â”‚ â”‚diseaseâ”‚stageâ”‚practiceâ”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â–¼        â”‚  â”‚ â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚          â”Œâ”€â”€â”€â”       â”‚  â”‚      (6 types)         â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚          â”‚ S â”‚       â”‚  â”‚  + aliases per concept â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚          â””â”€â”€â”€â”˜       â”‚  â”‚                        â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚        solved_by     â”‚  â”‚                        â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘   â”ƒ
â”ƒ   â•‘                                                                              â”‚                  â•‘   â”ƒ
â”ƒ   â•‘  â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”¼â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”  â•‘   â”ƒ
â”ƒ   â•‘    Cache Layer                                                               â”‚                  â•‘   â”ƒ
â”ƒ   â•‘  â”‚ [Query Cache] [Embedding Cache] [Response Cache]                          â”‚              â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”” â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”¼â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”˜  â•‘   â”ƒ
â”ƒ   â•‘                                                                              â”‚                  â•‘   â”ƒ
â”ƒ   â•‘                            Query                                             â”‚                  â•‘   â”ƒ
â”ƒ   â•‘                              â”‚                                               â”‚                  â•‘   â”ƒ
â”ƒ   â•‘                              â–¼                                               â–¼                  â•‘   â”ƒ
â”ƒ   â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘   â”ƒ
â”ƒ   â•‘  â”‚ (B) Hybrid Retrieval Pipeline â­                                      [Runtime Query]    â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                                                           â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ Query Analysisâ”‚     â”‚         3-Channel Search                 â”‚     â”‚   Context    â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚               â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚   Shaping    â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ â€¢ Ontology    â”‚â”€â”€â”€â”€â–¶â”‚  â”‚  Dense  â”‚ â”‚ Sparse  â”‚ â”‚  PathRAG    â”‚ â”‚â”€â”€â”€â”€â–¶â”‚              â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚   Matching    â”‚     â”‚  â”‚         â”‚ â”‚         â”‚ â”‚(conditional)â”‚ â”‚     â”‚ â€¢ Crop       â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚               â”‚     â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚   Filter     â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ â€¢ Dynamic     â”‚     â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚     â”‚ â€¢ Semantic   â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚   Alpha (DAT) â”‚     â”‚                   â–¼                      â”‚     â”‚   Dedup      â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚               â”‚     â”‚           [Score Fusion]                 â”‚     â”‚ â€¢ Reranking  â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ PathRAG       â”‚     â”‚                                          â”‚     â”‚  (memory-    â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ í™œì„±í™” ì¡°ê±´    â”‚     â”‚                                          â”‚     â”‚   aware)     â”‚  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘   â”ƒ
â”ƒ   â•‘                                                                                    â”‚            â•‘   â”ƒ
â”ƒ   â•‘                                                                                    â–¼            â•‘   â”ƒ
â”ƒ   â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘   â”ƒ
â”ƒ   â•‘  â”‚ (C) Answer Generation Pipeline                                        [Runtime Query]    â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                                                                           â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  success  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚  Prompt Builder  â”‚â”€â”€â”€â”€â–¶â”‚   LLM Engine    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚         Response            â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ â€¢ Jinja2 Templateâ”‚     â”‚  (llama.cpp)    â”‚           â”‚                             â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â”‚ â€¢ Custom Overrideâ”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  + Cache Store              â”‚   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ failure            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                                    â–¼                                    â–²                 â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚                 â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                       â”‚     Fallback Chain      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                       â”‚  1. Exact Cache         â”‚                                         â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                       â”‚  2. Similar Cache       â”‚                                         â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                       â”‚  3. Template Response   â”‚   (Offline Mode)                        â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                       â”‚  4. Search Only         â”‚                                         â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚  â•‘   â”ƒ
â”ƒ   â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘   â”ƒ
â”ƒ   â•‘                                                                                                 â•‘   â”ƒ
â”ƒ   â•‘  â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”  â•‘   â”ƒ
â”ƒ   â•‘    Monitoring & Stats: [Query Latency] [Cache Hit Rate] [Fallback Usage] [Retrieval Hits]      â•‘   â”ƒ
â”ƒ   â•‘  â”” â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”˜  â•‘   â”ƒ
â”ƒ   â•‘                                                                                                 â•‘   â”ƒ
â”ƒ   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”ƒ
â”ƒ                                                                                                         â”ƒ
â”ƒ   â›” No Cloud Required              âœ… Full Pipeline On-Device              ğŸ”’ Data Never Leaves Device â”ƒ
â”ƒ                                                                                                         â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
```

---

### 2.2 Compact Version (ë…¼ë¬¸ Figure 1 ê¶Œì¥)

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ  Edge Device (8GB RAM â”‚ Offline Capable)                                                     â”ƒ
â”ƒ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—â”ƒ
â”ƒ â•‘                                                                                           â•‘â”ƒ
â”ƒ â•‘  (A) Ingestion â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘â”ƒ
â”ƒ â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘â”ƒ
â”ƒ â•‘  â”‚  Data Sources  â”‚â”€â–¶â”‚Text Extract â”‚â”€â–¶â”‚Embedding â”‚â”€â–¶â”‚ Index + Graph Build              â”‚  â•‘â”ƒ
â”ƒ â•‘  â”‚(Local/HF/OCR)  â”‚  â”‚(+OCR Fallback)â”‚  â”‚          â”‚  â”‚ (Dense/Sparse/Causal)            â”‚  â•‘â”ƒ
â”ƒ â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘â”ƒ
â”ƒ â•‘                                                                     â”‚                     â•‘â”ƒ
â”ƒ â•‘                                                                     â–¼                     â•‘â”ƒ
â”ƒ â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘â”ƒ
â”ƒ â•‘  â”‚ ğŸ’¾ Knowledge Store: [Dense FAISS] [Sparse TF-IDF] [Causal Graph] [Ontology 6types] â”‚  â•‘â”ƒ
â”ƒ â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘â”ƒ
â”ƒ â•‘  â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”  â•‘â”ƒ
â”ƒ â•‘    Cache Layer: [Query] [Embedding] [Response]                                            â•‘â”ƒ
â”ƒ â•‘  â”” â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”˜  â•‘â”ƒ
â”ƒ â•‘                                                                     â”‚                     â•‘â”ƒ
â”ƒ â•‘  (B) Retrieval â­ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘â”ƒ
â”ƒ â•‘                                                                     â–¼                     â•‘â”ƒ
â”ƒ â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘â”ƒ
â”ƒ â•‘  â”‚ Query Analysisâ”‚  â”‚   3-Channel Hybrid Search          â”‚  â”‚    Context Shaping      â”‚   â•‘â”ƒ
â”ƒ â•‘  â”‚ + DAT         â”‚â”€â–¶â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”€â–¶â”‚ â€¢ Crop Filter           â”‚   â•‘â”ƒ
â”ƒ â•‘  â”‚               â”‚  â”‚ â”‚Dense â”‚Sparseâ”‚PathRAG         â”‚   â”‚  â”‚ â€¢ Semantic Dedup        â”‚   â•‘â”ƒ
â”ƒ â•‘  â”‚ (PathRAG      â”‚  â”‚ â”‚      â”‚      â”‚(conditional)   â”‚   â”‚  â”‚ â€¢ Reranking (adaptive)  â”‚   â•‘â”ƒ
â”ƒ â•‘  â”‚  activation)  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘â”ƒ
â”ƒ â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         Score Fusion               â”‚              â”‚                 â•‘â”ƒ
â”ƒ â•‘                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                 â•‘â”ƒ
â”ƒ â•‘                                                                         â”‚                 â•‘â”ƒ
â”ƒ â•‘  (C) Generation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â•‘â”ƒ
â”ƒ â•‘                                                                         â–¼                 â•‘â”ƒ
â”ƒ â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  success  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â•‘â”ƒ
â”ƒ â•‘  â”‚  Prompt Builder  â”‚â”€â–¶â”‚   LLM Engine    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚         Response              â”‚    â•‘â”ƒ
â”ƒ â•‘  â”‚(Jinja2 + Custom) â”‚  â”‚  (llama.cpp)    â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â•‘â”ƒ
â”ƒ â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â–²                        â•‘â”ƒ
â”ƒ â•‘                                 â”‚ failure                        â”‚                        â•‘â”ƒ
â”ƒ â•‘                                 â–¼                                â”‚                        â•‘â”ƒ
â”ƒ â•‘                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚                        â•‘â”ƒ
â”ƒ â•‘                     â”‚    Fallback Chain     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â•‘â”ƒ
â”ƒ â•‘                     â”‚ Exact â†’ Similar Cache â”‚                                             â•‘â”ƒ
â”ƒ â•‘                     â”‚ â†’ Template â†’ Search   â”‚  (Offline Mode)                             â•‘â”ƒ
â”ƒ â•‘                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â•‘â”ƒ
â”ƒ â•‘                                                                                           â•‘â”ƒ
â”ƒ â•‘  â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”  â•‘â”ƒ
â”ƒ â•‘    Monitoring: [Latency] [Cache Hits] [Fallback Stats]                                    â•‘â”ƒ
â”ƒ â•‘  â”” â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”˜  â•‘â”ƒ
â”ƒ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
```

---

## 3. Pipelineë³„ ìƒì„¸ ëª…ì„¸

### 3.1 Pipeline A: Knowledge Ingestion

**ì—­í• **: ì›ì‹œ ë¬¸ì„œë¥¼ ê²€ìƒ‰ ê°€ëŠ¥í•œ ì§€ì‹ ë² ì´ìŠ¤ë¡œ ë³€í™˜ (ì˜¤í”„ë¼ì¸, 1íšŒì„±)

**ë°°ê²½ìƒ‰**: ì—°í•œ ë³´ë¼ (`#F3E5F5`)

**ë¼ë²¨**: `[Offline Build]` ë±ƒì§€

#### ì»´í¬ë„ŒíŠ¸ êµ¬ì„±

| ìˆœì„œ | ë°•ìŠ¤ | ë‚´ìš© | ì•„ì´ì½˜ |
|------|------|------|--------|
| 1 | Data Sources | Local Files (PDF/HWP/TXT)<br>HuggingFace Datasets | ğŸ“„ ë¬¸ì„œ |
| 2 | Text Extraction | PDF/HWP íŒŒì‹±<br>OCR Fallback (multi-backend) | âœ‚ï¸ ê°€ìœ„ |
| 3 | Embedding | Qwen3-Embedding ë˜ëŠ” MiniLM | ğŸ”¢ ë²¡í„° |
| 4 | Index & Graph Build | Dense (FAISS)<br>Sparse (TF-IDF)<br>Causal Graph | ğŸ—ï¸ ë¹Œë“œ |

#### OCR Fallback Chain (ì„œë¸Œ ë°•ìŠ¤)

```
Text Extraction ë‚´ë¶€:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Text-First Strategy               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  1. PDF Native Parse (pypdf)       â”‚
â”‚  2. Layout-aware (pdfplumber)      â”‚
â”‚  3. OCR Fallback (if text sparse)  â”‚
â”‚     â†’ DeepSeek-OCR (GGUF)          â”‚
â”‚     â†’ EasyOCR                      â”‚
â”‚     â†’ PaddleOCR                    â”‚
â”‚     â†’ Tesseract                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Causal Role Detection (ì„œë¸Œ ë°•ìŠ¤)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Causal Role Detection              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â€¢ cause: "ì›ì¸", "ë•Œë¬¸", "~í•˜ë©´"    â”‚
â”‚  â€¢ effect: "ê²°ê³¼", "ì¦ìƒ", "ë¬¸ì œ"    â”‚
â”‚  â€¢ solution: "ë°©ë²•", "ê´€ë¦¬", "ì¡°ì¹˜"  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í™”ì‚´í‘œ**: ì™¼ìª½â†’ì˜¤ë¥¸ìª½ ì‹¤ì„ , ë§ˆì§€ë§‰ì— ì•„ë˜ë¡œ êº¾ì—¬ Knowledge Storeë¡œ

---

### 3.2 Knowledge Store (ì¤‘ì•™ ì €ì¥ì†Œ)

**ì—­í• **: ëª¨ë“  ê²€ìƒ‰ ê°€ëŠ¥í•œ ì§€ì‹ì˜ ì¤‘ì•™ ì €ì¥ì†Œ

**ë°°ê²½ìƒ‰**: ì—°í•œ íšŒìƒ‰ (`#ECEFF1`)

**í…Œë‘ë¦¬**: ì ì„  (ë””ìŠ¤í¬/í”Œë˜ì‹œ ì €ì¥ì†Œ í‘œí˜„)

#### êµ¬ì„± ìš”ì†Œ (4ê°œ ë°•ìŠ¤ ê°€ë¡œ ë°°ì¹˜)

| ë°•ìŠ¤ | ì´ë¦„ | ë‚´ìš© | í¬ê¸° ë¹„ìœ¨ |
|------|------|------|----------|
| 1 | Dense Index | FAISS (IndexFlatIP)<br>mmap ì§€ì› | 25% |
| 2 | Sparse Index | TF-IDF (sklearn)<br>í‚¤ì›Œë“œ/ìˆ˜ì¹˜ ë§¤ì¹­ | 25% |
| 3 | Causal Graph | `causes` / `solved_by` ì—£ì§€<br>Câ†’Eâ†’S ì¸ê³¼ ì²´ì¸ | 25% |
| 4 | Domain Ontology | 6 types (crop, env, nutrient,<br>disease, stage, practice)<br>+ aliases | 25% |

#### Causal Graph ë‚´ë¶€ í‘œí˜„

```
  â”Œâ”€â”€â”€â”          â”Œâ”€â”€â”€â”
  â”‚ C â”‚â”€causesâ”€â”€â–¶â”‚ E â”‚
  â””â”€â”€â”€â”˜          â””â”€â”¬â”€â”˜
                   â”‚ solved_by
                   â–¼
                â”Œâ”€â”€â”€â”
                â”‚ S â”‚
                â””â”€â”€â”€â”˜
```
- C: Cause (ì›ì¸)
- E: Effect (ê²°ê³¼)
- S: Solution (í•´ê²°ì±…)

#### Ontology ë‚´ë¶€ í‘œí˜„

```
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚crop â”‚ env â”‚ nutrient â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚diseaseâ”‚stageâ”‚practiceâ”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     (6 types)
```

---

### 3.3 Cache Layer (ë³´ì¡° ë ˆì´ì–´)

**ì—­í• **: ì¿¼ë¦¬/ì„ë² ë”©/ì‘ë‹µ ìºì‹±ìœ¼ë¡œ ì§€ì—° ì‹œê°„ ìµœì í™”

**í…Œë‘ë¦¬**: ì ì„  (ì„ íƒì /ë³´ì¡° ì»´í¬ë„ŒíŠ¸)

#### êµ¬ì„± ìš”ì†Œ

| ìºì‹œ | ì—­í•  | ìœ„ì¹˜ |
|------|------|------|
| Query Cache | ê²€ìƒ‰ ê²°ê³¼ ìºì‹± | Retrieval ì „ |
| Embedding Cache | ì¿¼ë¦¬ ì„ë² ë”© ì¬ì‚¬ìš© | Embedding ì—°ì‚° |
| Response Cache | LLM ì‘ë‹µ ì¬í™œìš© | Generation í›„ |

---

### 3.4 Pipeline B: Hybrid Retrieval â­

**ì—­í• **: 3ì±„ë„ í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ + ì»¨í…ìŠ¤íŠ¸ ì••ì¶• (ëŸ°íƒ€ì„, í•µì‹¬ ê¸°ì—¬)

**ë°°ê²½ìƒ‰**: ì—°í•œ íŒŒë‘ (`#E3F2FD`)

**í…Œë‘ë¦¬**: **êµµì€ ê°•ì¡° í…Œë‘ë¦¬** (ë…¼ë¬¸ í•µì‹¬ ê¸°ì—¬)

**ë¼ë²¨**: `â­ Key Contribution` + `[Runtime Query]`

#### ì»´í¬ë„ŒíŠ¸ êµ¬ì„±

**Stage 1: Query Analysis + DAT**

| ë°•ìŠ¤ | ë‚´ìš© |
|------|------|
| Ontology Matching | ì§ˆì˜ì—ì„œ ê°œë… ì¶”ì¶œ<br>ì˜ˆ: `crop: ì™€ì‚¬ë¹„`, `env: ì˜¨ë„` |
| Dynamic Alpha Tuning | ì§ˆì˜ íŠ¹ì„±ì— ë”°ë¥¸ ê°€ì¤‘ì¹˜ ê²°ì • |
| PathRAG í™œì„±í™” ì¡°ê±´ | disease/practice/stage ë§¤ì¹­ ì‹œ í™œì„±í™” |

**Stage 2: 3-Channel Search**

| ì±„ë„ | ìƒ‰ìƒ | ë‚´ìš© | ì¡°ê±´ |
|------|------|------|------|
| Dense | ì§„í•œ íŒŒë‘ (`#BBDEFB`) | FAISS ë²¡í„° ê²€ìƒ‰<br>ì˜ë¯¸ì  ìœ ì‚¬ë„ | í•­ìƒ í™œì„± |
| Sparse | ì—°ë‘ (`#C8E6C9`) | TF-IDF í‚¤ì›Œë“œ ë§¤ì¹­<br>ìˆ˜ì¹˜/ë‹¨ìœ„ ì •í™•ë„ | í•­ìƒ í™œì„± |
| PathRAG | ë¶„í™ (`#F8BBD0`) | Graph BFS íƒìƒ‰<br>ì¸ê³¼ê´€ê³„ ì¶”ë¡  | **ì¡°ê±´ë¶€ í™œì„±** |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dense  â”‚  â”‚ Sparse  â”‚  â”‚   PathRAG    â”‚
â”‚         â”‚  â”‚         â”‚  â”‚ (conditional)â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
          [Score Fusion]
```

**Stage 3: Context Shaping â­**

| ìˆœì„œ | ë°•ìŠ¤ | ë™ì‘ | íš¨ê³¼ |
|------|------|------|------|
| 1 | Crop Filter | ì‘ë¬¼ ë§¤ì¹­ ê¸°ë°˜ ìŠ¤ì½”ì–´ ì¡°ì • | ë„ë©”ì¸ ì •í™•ë„ |
| 2 | Semantic Dedup | ìœ ì‚¬ ë¬¸ì„œ ì œê±° | ë‹¤ì–‘ì„± í™•ë³´ |
| 3 | Reranking | Memory-aware ë¦¬ë­í‚¹<br>(BGE / LLM-lite / none) | í’ˆì§ˆ í–¥ìƒ |

---

### 3.5 Pipeline C: Answer Generation

**ì—­í• **: LLM ê¸°ë°˜ ì‘ë‹µ ìƒì„± + ì˜¤í”„ë¼ì¸ í´ë°± (ëŸ°íƒ€ì„)

**ë°°ê²½ìƒ‰**: ì—°í•œ ì´ˆë¡ (`#E8F5E9`)

**ë¼ë²¨**: `[Runtime Query]`

#### ì»´í¬ë„ŒíŠ¸ êµ¬ì„±

**ì •ìƒ ê²½ë¡œ (ì‹¤ì„ )**:

| ìˆœì„œ | ë°•ìŠ¤ | ë‚´ìš© |
|------|------|------|
| 1 | Prompt Builder | Jinja2 í…œí”Œë¦¿ ê¸°ë°˜<br>Custom Override ì§€ì› |
| 2 | LLM Engine | llama.cpp (GGUF ì–‘ìí™”) |
| 3 | Response | ìƒì„±ëœ ì‘ë‹µ + Cache ì €ì¥ |

**í´ë°± ê²½ë¡œ (ì ì„ ) - 4ë‹¨ê³„**:

| ë‹¨ê³„ | ë™ì‘ | ì„¤ëª… |
|------|------|------|
| 1 | Exact Cache | ì •í™•íˆ ë™ì¼í•œ ì§ˆì˜ ìºì‹œ íˆíŠ¸ |
| 2 | Similar Cache | ì„ë² ë”© ìœ ì‚¬ë„ ê¸°ë°˜ ìºì‹œ íƒìƒ‰ |
| 3 | Template Response | ì˜¨í†¨ë¡œì§€ ê¸°ë°˜ ì •í˜• ì‘ë‹µ ìƒì„± |
| 4 | Search Only | ê²€ìƒ‰ ê²°ê³¼ë§Œ ë°˜í™˜ (LLM ì—†ì´) |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  success  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Prompt Builder  â”‚â”€â”€â”€â”€â–¶â”‚ LLM Engine  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Response â”‚
â”‚(Jinja2 + Custom) â”‚     â”‚(llama.cpp)  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                 â–²
                               â”‚ failure                 â”‚
                               â–¼                         â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
                  â”‚     Fallback Chain      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚  1. Exact Cache         â”‚
                  â”‚  2. Similar Cache       â”‚
                  â”‚  3. Template Response   â”‚
                  â”‚  4. Search Only         â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.6 Monitoring Layer (ë³´ì¡° ë ˆì´ì–´)

**ì—­í• **: ìš´ì˜ ì§€í‘œ ìˆ˜ì§‘ ë° ì¶”ì 

**í…Œë‘ë¦¬**: ì ì„  (í•µì‹¬ íŒŒì´í”„ë¼ì¸ ì™¸ë¶€)

#### ìˆ˜ì§‘ ì§€í‘œ

| ì§€í‘œ | ì„¤ëª… |
|------|------|
| Query Latency | ì§ˆì˜ â†’ ì‘ë‹µ ì „ì²´ ì‹œê°„ |
| Cache Hit Rate | ìºì‹œ ì ì¤‘ë¥  |
| Fallback Usage | í´ë°± ëª¨ë“œ ì‚¬ìš© ë¹„ìœ¨ |
| Retrieval Hits | ê²€ìƒ‰ ê²°ê³¼ ìˆ˜ |

---

## 4. ì‹œê°ì  ìŠ¤íƒ€ì¼ ê°€ì´ë“œ

### 4.1 ìƒ‰ìƒ íŒ”ë ˆíŠ¸

| ìš”ì†Œ | ìƒ‰ìƒëª… | HEX | RGB | ìš©ë„ |
|------|--------|-----|-----|------|
| Edge ì™¸ê³½ | ì§„í•œ íšŒìƒ‰ | `#37474F` | 55, 71, 79 | ë””ë°”ì´ìŠ¤ ê²½ê³„ |
| Pipeline A | ì—°í•œ ë³´ë¼ | `#F3E5F5` | 243, 229, 245 | Ingestion |
| Knowledge Store | ì—°í•œ íšŒìƒ‰ | `#ECEFF1` | 236, 239, 241 | ì €ì¥ì†Œ |
| Cache/Monitoring | íˆ¬ëª… + ì ì„  | - | - | ë³´ì¡° ë ˆì´ì–´ |
| Pipeline B â­ | ì—°í•œ íŒŒë‘ | `#E3F2FD` | 227, 242, 253 | Retrieval |
| Pipeline C | ì—°í•œ ì´ˆë¡ | `#E8F5E9` | 232, 245, 233 | Generation |
| Dense ì±„ë„ | ì§„í•œ íŒŒë‘ | `#BBDEFB` | 187, 222, 251 | ë²¡í„° ê²€ìƒ‰ |
| Sparse ì±„ë„ | ì—°ë‘ | `#C8E6C9` | 200, 230, 201 | í‚¤ì›Œë“œ ê²€ìƒ‰ |
| PathRAG ì±„ë„ | ë¶„í™ | `#F8BBD0` | 248, 187, 208 | ê·¸ë˜í”„ ê²€ìƒ‰ |
| Context Shaping | ë…¸ë‘ | `#FFF9C4` | 255, 249, 196 | í•µì‹¬ ê¸°ì—¬ ê°•ì¡° |
| Fallback | ì£¼í™© | `#FFE0B2` | 255, 224, 178 | ëŒ€ì²´ ê²½ë¡œ |

### 4.2 í…Œë‘ë¦¬ & ì„  ìŠ¤íƒ€ì¼

| ìš”ì†Œ | ìŠ¤íƒ€ì¼ | ë‘ê»˜ | ì„¤ëª… |
|------|--------|------|------|
| Edge ì™¸ê³½ | ì‹¤ì„  + ë‘¥ê·¼ ëª¨ì„œë¦¬ | 3px | ë””ë°”ì´ìŠ¤ ë¬¼ë¦¬ ê²½ê³„ |
| Pipeline ì„¹ì…˜ | ì‹¤ì„  | 1px | ì¼ë°˜ ì»´í¬ë„ŒíŠ¸ |
| í•µì‹¬ ê¸°ì—¬ (B) | êµµì€ ì‹¤ì„  | 2px | ê°•ì¡° |
| Knowledge Store | ì ì„  | 1px | ì €ì¥ì†Œ (ë””ìŠ¤í¬) |
| Cache/Monitoring | ì ì„  | 1px | ë³´ì¡° ë ˆì´ì–´ |
| ì •ìƒ íë¦„ í™”ì‚´í‘œ | ì‹¤ì„  | 1.5px | ë°ì´í„° íë¦„ |
| í´ë°± íë¦„ í™”ì‚´í‘œ | ì ì„  | 1px | ëŒ€ì²´ ê²½ë¡œ |
| ì¡°ê±´ë¶€ ì»´í¬ë„ŒíŠ¸ | ì ì„  í…Œë‘ë¦¬ | 1px | ì„ íƒì  í™œì„±í™” |

### 4.3 ì•„ì´ì½˜ ì œì•ˆ

| ì»´í¬ë„ŒíŠ¸ | ì•„ì´ì½˜ | ëŒ€ì•ˆ |
|----------|--------|------|
| Edge Device | ğŸ“± ë˜ëŠ” ğŸ–¥ï¸ | ì¹© ì•„ì´ì½˜ |
| Data Sources | ğŸ“„ | ë¬¸ì„œ ìŠ¤íƒ |
| Text Extraction | âœ‚ï¸ | í…ìŠ¤íŠ¸ ë¶„í•  |
| Embedding | ğŸ”¢ | ë²¡í„° í™”ì‚´í‘œ |
| Knowledge Store | ğŸ’¾ | ë°ì´í„°ë² ì´ìŠ¤ |
| Cache Layer | ğŸ—„ï¸ | ìºì‹œ ì•„ì´ì½˜ |
| LLM Engine | ğŸ§  | CPU/ë‡Œ |
| Fallback | âš¡ | ëŒ€ì²´ í™”ì‚´í‘œ |
| Monitoring | ğŸ“Š | ì°¨íŠ¸ ì•„ì´ì½˜ |

### 4.4 ë±ƒì§€ ë””ìì¸

| ë±ƒì§€ | ìœ„ì¹˜ | ìƒ‰ìƒ | í…ìŠ¤íŠ¸ |
|------|------|------|--------|
| ë¦¬ì†ŒìŠ¤ ì œì•½ | Edge ì™¸ê³½ ìš°ìƒë‹¨ | íšŒìƒ‰ ë°°ê²½ | `8GB RAM â”‚ Q4_K_M â”‚ Offline` |
| ì˜¤í”„ë¼ì¸ ë¹Œë“œ | Pipeline A ìš°ìƒë‹¨ | ë³´ë¼ ë°°ê²½ | `[Offline Build]` |
| ëŸ°íƒ€ì„ ì¿¼ë¦¬ | Pipeline B, C ìš°ìƒë‹¨ | íŒŒë‘/ì´ˆë¡ ë°°ê²½ | `[Runtime Query]` |
| í•µì‹¬ ê¸°ì—¬ | Pipeline B ì œëª© ì˜† | ë…¸ë‘ ë°°ê²½ | `â­ Key Contribution` |
| ì¡°ê±´ë¶€ | PathRAG ë°•ìŠ¤ | íšŒìƒ‰ ë°°ê²½ | `(conditional)` |

---

## 5. ë ˆì´ì•„ì›ƒ ë¹„ìœ¨ ê°€ì´ë“œ

### 5.1 ì„¸ë¡œ ë¹„ìœ¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  (A) Ingestion                          â”‚  15%
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Knowledge Store                        â”‚  12%
â”œâ”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”¤
â”‚  Cache Layer (ì ì„ )                     â”‚   5%
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  (B) Retrieval â­                        â”‚  30%  â† ê°€ì¥ í¬ê²Œ
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  (C) Generation                         â”‚  28%
â”œâ”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”„â”¤
â”‚  Monitoring (ì ì„ )                      â”‚   5%
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Footer (ì•„ì´ì½˜/ë©”ì‹œì§€)                  â”‚   5%
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ê°€ë¡œ ë¹„ìœ¨ (Pipeline B ë‚´ë¶€)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Query      â”‚     3-Channel Search         â”‚   Context   â”‚
â”‚  Analysis   â”‚  [Dense][Sparse][PathRAG]    â”‚   Shaping   â”‚
â”‚  + DAT      â”‚       + Fusion               â”‚             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    20%      â”‚           50%                â”‚    30%      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ì²´í¬ë¦¬ìŠ¤íŠ¸ (ë””ìì´ë„ˆìš©)

### 6.1 í•„ìˆ˜ ìš”ì†Œ

- [ ] ë‘êº¼ìš´ ì™¸ê³½ì„ ìœ¼ë¡œ Edge Device ê²½ê³„ í‘œí˜„
- [ ] 3ê°œ Pipeline (A, B, C)ì´ ìˆ˜ì§ìœ¼ë¡œ êµ¬ë¶„ë¨
- [ ] Knowledge Storeê°€ ì¤‘ì•™ì— ê³µìœ  ì €ì¥ì†Œë¡œ í‘œí˜„ë¨
- [ ] Cache Layerê°€ ì ì„ ìœ¼ë¡œ í‘œí˜„ë¨
- [ ] Pipeline Bì— 3ì±„ë„ (Dense, Sparse, PathRAG)ì´ ë³‘ë ¬ ë°°ì¹˜
- [ ] PathRAGì— `(conditional)` í‘œì‹œ
- [ ] Fallback Chainì´ 4ë‹¨ê³„ë¡œ í‘œí˜„ë¨
- [ ] Monitoring Layerê°€ í•˜ë‹¨ì— ì ì„ ìœ¼ë¡œ í‘œí˜„ë¨
- [ ] `8GB RAM`, `Offline` ë±ƒì§€ í‘œì‹œ

### 6.2 ê¶Œì¥ ìš”ì†Œ

- [ ] ê° Pipelineë³„ ë°°ê²½ìƒ‰ êµ¬ë¶„
- [ ] 3ì±„ë„ë³„ ìƒ‰ìƒ êµ¬ë¶„ (íŒŒë‘, ì—°ë‘, ë¶„í™)
- [ ] â­ ì•„ì´ì½˜ìœ¼ë¡œ í•µì‹¬ ê¸°ì—¬ ê°•ì¡°
- [ ] í™”ì‚´í‘œë¡œ ë°ì´í„° íë¦„ í‘œí˜„
- [ ] Causal Graph ë‚´ë¶€ì— Câ†’Eâ†’S ë¯¸ë‹ˆ ë‹¤ì´ì–´ê·¸ë¨
- [ ] Prompt Builderì— "Custom Override" í‘œì‹œ
- [ ] í•˜ë‹¨ì— "No Cloud / On-Device / Privacy" ë©”ì‹œì§€

### 6.3 ì„ íƒ ìš”ì†Œ

- [ ] ì•„ì´ì½˜ (ë¬¸ì„œ, ë²¡í„°, DB, ë‡Œ ë“±)
- [ ] ê·¸ë¦¼ì/ì…ì²´ íš¨ê³¼
- [ ] OCR Fallback ì²´ì¸ ìƒì„¸
- [ ] Ontology 6 types ì„¸ë¶€ í‘œì‹œ

---

## 7. ì½”ë“œ-Figure ë§¤í•‘

| Figure ìš”ì†Œ | ì†ŒìŠ¤ ì½”ë“œ ìœ„ì¹˜ |
|------------|---------------|
| **Pipeline A: Ingestion** | `core/Services/Ingest/` |
| - Data Sources | `DocumentProcessor.py`, `HuggingFace.py` |
| - Text Extraction | `DocumentProcessor.py`, `OCREngine.py` |
| - Chunking | `Chunking.py` |
| - Graph Build | `GraphBuilder.py` |
| **Knowledge Store** | `core/Api/deps.py` (ì´ˆê¸°í™”) |
| - Dense Index | `core/Services/Retrieval/Embeddings.py` |
| - Sparse Index | `core/Services/Retrieval/Sparse.py` |
| - Causal Graph | `core/Models/Graph.py` |
| - Ontology | `core/Services/Ontology.py` |
| **Cache Layer** | |
| - Query Cache | `core/Services/Retrieval/Hybrid.py` (`SimpleQueryCache`) |
| - Embedding Cache | `core/Services/Retrieval/Embeddings.py` |
| - Response Cache | `core/Services/ResponseCache.py` |
| **Pipeline B: Retrieval** | `core/Services/Retrieval/Hybrid.py` |
| - Ontology Matching | `OntologyMatcher.match()` |
| - Dynamic Alpha | `dynamic_alphas()` |
| - 3-Channel Search | `search()` ë‚´ë¶€ |
| - PathRAG | `core/Services/Retrieval/PathRAG.py` |
| - Context Shaping | `_apply_crop_filter()`, `_deduplicate()` |
| **Pipeline C: Generation** | `core/Api/routes_query.py` |
| - Prompt Builder | `core/Services/PromptTemplates.py` |
| - Custom Override | `core/Services/PromptStorage.py` |
| - LLM Engine | `core/Services/LLM.py` |
| - Fallback Chain | `ResponseCache.py`, `TemplateResponder.py` |
| **Monitoring** | `core/Api/routes_monitoring.py` |

---

## 8. ëŒ€ì•ˆ ë ˆì´ì•„ì›ƒ

### 8.1 ì´ˆê°„ëµ ë²„ì „ (ìŠ¬ë¼ì´ë“œìš©)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Edge Device (8GB RAM, Offline)                                     â”‚
â”‚                                                                     â”‚
â”‚  Sources â†’ [Ingest] â†’ ğŸ’¾ Knowledge Store â† [Cache Layer]           â”‚
â”‚                              â”‚                                      â”‚
â”‚  Query â†’ [3-Ch Retrieval â­] â†’ [Shaping] â†’ [LLM] â†’ Response         â”‚
â”‚                                             â†“                       â”‚
â”‚                                      [Fallback Chain]               â”‚
â”‚                                                                     â”‚
â”‚  â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ [Monitoring] â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 ìˆ˜ì§ ê°•ì¡° ë²„ì „ (í¬ìŠ¤í„°ìš©)

```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Edge Device    â”‚
        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚   â”‚ Ingest   â”‚   â”‚
        â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚        â–¼         â”‚
        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚   â”‚Knowledge â”‚   â”‚
        â”‚   â”‚  Store   â”‚   â”‚
        â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚   â”Œ â”€ â”€â”´â”€ â”€ â”€â”   â”‚
        â”‚     Cache        â”‚
        â”‚   â”” â”€ â”€â”¬â”€ â”€ â”€â”˜   â”‚
        â”‚        â–¼         â”‚
        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚   â”‚Retrievalâ­â”‚   â”‚
        â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚        â–¼         â”‚
        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚   â”‚Generationâ”‚   â”‚
        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â”‚   â”Œ â”€ â”€ â”€ â”€ â”€â”   â”‚
        â”‚    Monitoring    â”‚
        â”‚   â”” â”€ â”€ â”€ â”€ â”€â”˜   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. ì°¸ê³  ìë£Œ

### 9.1 ê´€ë ¨ ë¬¸ì„œ

- ìƒì„¸ Mermaid ë‹¤ì´ì–´ê·¸ë¨: [ARCHITECTURE_MERMAID.md](ARCHITECTURE_MERMAID.md)
- ê¸°ìˆ  ìƒì„¸ ëª…ì„¸: [ARCHITECTURE_FIGURE_DESIGN.md](ARCHITECTURE_FIGURE_DESIGN.md)
- ë°©ë²•ë¡  ì„¹ì…˜: [../03_methodology.md](../03_methodology.md)

### 9.2 ì°¸ê³ í•œ ë…¼ë¬¸ Figure íŒ¨í„´

| ë…¼ë¬¸ | Figure ìŠ¤íƒ€ì¼ | ì°¸ê³  í¬ì¸íŠ¸ |
|------|--------------|-------------|
| Self-RAG (ICLR 2024) | ìˆ˜í‰ íŒŒì´í”„ë¼ì¸ + ë°˜ë³µ ë£¨í”„ | ìê¸° ë°˜ì„± ë©”ì»¤ë‹ˆì¦˜ í‘œí˜„ |
| CRAG (arXiv 2024) | ì¡°ê±´ë¶€ ë¶„ê¸° í”Œë¡œìš° | í‰ê°€ê¸° ê¸°ë°˜ ë™ì  ì²˜ë¦¬ |
| Modular RAG | LEGO ë¸”ë¡ ì¡°í•© | ëª¨ë“ˆ êµì²´ ê°€ëŠ¥ì„± |
| MobileRAG | 2-Layer ì¸ë±ì‹± | ë©”ëª¨ë¦¬ ê³„ì¸µ í‘œí˜„ |
| EdgeRAG | ë””ë°”ì´ìŠ¤ ê²½ê³„ ë°•ìŠ¤ | ì—£ì§€ ì œì•½ ê°•ì¡° |

---

## ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| v1.0 | - | ì´ˆê¸° 6-Layer ìˆ˜ì§ ìŠ¤íƒ ë””ìì¸ |
| v2.0 | 2025-01-14 | 3-Pipeline ìˆ˜í‰ í”Œë¡œìš° + ì—£ì§€ ê²½ê³„ ë°•ìŠ¤ë¡œ ì „ë©´ ê°œí¸ |
| v2.1 | 2025-01-14 | ì‹¤ì œ êµ¬í˜„ê³¼ ëŒ€ì¡°í•˜ì—¬ ëˆ„ë½ êµ¬ì¡° ë³´ì™„:<br>â€¢ Cache Layer (Query/Embedding/Response) ì¶”ê°€<br>â€¢ Data Sources í™•ì¥ (HuggingFace, OCR Fallback)<br>â€¢ PathRAG ì¡°ê±´ë¶€ í™œì„±í™” ëª…ì‹œ<br>â€¢ Fallback Chain 4ë‹¨ê³„ë¡œ í™•ì¥ (Similar Cache ì¶”ê°€)<br>â€¢ Prompt Builderì— Custom Override ì¶”ê°€<br>â€¢ Monitoring Layer ì¶”ê°€ |
