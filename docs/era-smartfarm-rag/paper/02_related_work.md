# 2. 관련 연구 (Related Work)

## 2.1 Retrieval-Augmented Generation (RAG)

RAG는 대규모 언어 모델(LLM)의 생성 과정에 외부 지식 베이스 검색을 결합하여 환각(hallucination, LLM이 사실이 아닌 내용을 마치 사실인 것처럼 생성하는 현상)을 줄이고 도메인 특화 지식을 제공하는 접근법이다[1]. Gao et al.(2024)의 서베이에 따르면 RAG 패러다임은 Naive RAG(단순 검색-생성)에서 Advanced RAG(쿼리 변환, 리랭킹 등 추가), Modular RAG(컴포넌트 조합 가능)로 진화하였으며, 검색(retrieval), 증강(augmentation), 생성(generation)의 세 축을 중심으로 발전하고 있다[2]. 최근에는 GraphRAG, PathRAG 등 문서들의 관계를 그래프로 구조화하여 검색하는 그래프 기반 RAG가 주목받고 있으며[3], 농업 분야에서도 지식 그래프와 LLM의 결합이 연구되고 있다[4].

2025년 농업 도메인 RAG 연구가 본격화되었다. **Crop GraphRAG**[33]는 병해충 지식 그래프와 RAG를 결합하여 환각을 억제하였고, **AHR-RAG**[34]는 91만 트리플릿 KB와 적응형 하이브리드 검색(단일홉/다중홉)으로 복잡 질의에 대응하였다. **ReG-RAG**[35]는 쿼리 재작성과 지식 그래프 강화를 결합하였으며, **AgroMetLLM**[36]은 Raspberry Pi에서 양자화 LLM으로 오프라인 농업 자문을 구현하였다.

**한계점:** Crop GraphRAG[33]와 AHR-RAG[34]는 엣지/오프라인 환경을 다루지 않았으며, AHR-RAG[34]는 91만 트리플릿 규모 KB를 전제한다. AgroMetLLM[36]은 Raspberry Pi에서 엣지 배포를 달성했으나 증발산(ET) 예측 및 관개 자문에 특화되어 있다.

**본 연구의 대응:** 양자화 기반 8GB RAM 엣지 배포와 오프라인 폴백 모드로 자원 제약 환경을 지원하고, 대규모 KB 없이 규칙 기반 경량 온톨로지로 농업 도메인 특화 검색을 구현한다.

## 2.2 Hybrid Retrieval

Dense retrieval(BERT 등 딥러닝 모델로 텍스트를 벡터로 변환하여 의미적 유사성으로 검색)은 "수분 스트레스"와 "물 부족"처럼 다른 표현이지만 같은 의미인 문서를 찾을 수 있으나, "EC 2.5 dS/m" 같은 수치 정보 매칭에 취약하다. 반면 Sparse retrieval(BM25, TF-IDF 등 키워드 빈도 기반 검색)은 정확한 단어가 일치해야 하므로 의미적 유사성을 놓칠 수 있지만, 수치와 단위의 정확한 매칭에 강하다[5]. Hybrid retrieval은 두 방식을 융합하여 각각의 약점을 보완한다. SIGIR 2024의 클러스터 기반 부분 Dense 검색 연구는 Sparse 검색 결과를 가이드로 활용하여 융합 최적화를 달성하였다[6].

**한계점:** 기존 Hybrid retrieval은 Dense와 Sparse 2채널 융합에 머물며, 그래프 기반 검색과의 결합이 부족하다. 또한 고정 가중치를 사용하여 질의 특성에 따른 적응적 조정이 이루어지지 않는다.

**본 연구의 대응:** Dense-Sparse-PathRAG 3채널 융합을 도입하고, 질의의 수치/단위 포함 여부와 온톨로지 매칭 결과에 따라 채널 가중치를 동적으로 조정한다.

## 2.3 Graph-based RAG

Microsoft Research의 GraphRAG(2024)는 문서들 사이의 관계를 지식 그래프(노드=개념, 엣지=관계)로 구조화하여 "전체 문서를 요약해줘"와 같은 전역적 질의(global query)에 대응한다[7]. **PathRAG**(Chen et al., 2025)는 그래프 내 관계 경로(relational path, 노드와 노드를 연결하는 엣지들의 연쇄)를 따라 검색하여 "비슷한 내용의 문서만 계속 나오는" 중복성 문제를 해결하며, 농업(Agriculture) 포함 6개 도메인에서 GraphRAG, LightRAG[32] 대비 우수한 성능을 보였다[8].

**한계점:** GraphRAG는 LLM으로 문서에서 개체(entity)와 관계를 추출해야 하므로 구축 비용이 높다(문서 1000개당 GPT-4 수천 회 호출 → $100+). PathRAG는 범용 관계 유형만 사용하여 농업 도메인의 "고수온 → 연부병 발생 → 수온 관리"와 같은 인과관계(원인-결과-해결책) 구조를 명시적으로 모델링하지 않는다. 두 방식 모두 엣지 환경에서의 경량화 고려가 부족하다.

**본 연구의 대응:** 규칙 기반 패턴 매칭으로 **인과관계 그래프** 구축 시 LLM/NER 모델 없이(비용 $0) 구축하고(단, Dense 인덱스는 임베딩 모델 사용), PathRAG[8]의 경로 탐색 개념을 차용한 경량 구현(PathRAG-lite, BFS 기반 2-hop 탐색)을 적용한다. `causes`(원인→결과), `solved_by`(문제→해결책) 엣지 타입으로 농업 도메인의 인과 구조를 명시적으로 표현한다.

## 2.4 농업 도메인 온톨로지 및 지식 그래프

농업 분야에서 온톨로지(ontology, 특정 도메인의 개념들과 그 관계를 정의한 지식 체계) 기반 지식 표현이 활발히 연구되고 있다. Bhuyan et al.(2021)은 시공간 농업 데이터에 대한 추론을 지원하는 래티스(lattice, 개념들을 계층적 격자 구조로 정리) 구조를 제안하였다[9]. NLP를 활용한 농업 온톨로지 개발 방법론[10], 스마트 농업의 시공간 역학을 포착하는 온톨로지 솔루션[11] 등이 발표되었다.

**CropDP-KG**(2025)는 NER(Named Entity Recognition, 텍스트에서 작물명/병해명/환경요소 등 주요 개체 추출)과 RE(Relation Extraction, 추출된 개체들 사이의 관계 식별)를 활용하여 13,840개 엔티티와 21,961개 관계를 자동 구축하였다[12]. 토마토 잎 병해충 지식 그래프(2024)는 Stanford 온톨로지 구축 방법론의 6단계 프로세스를 적용하였다[13].

**한계점:** 기존 농업 온톨로지는 주로 지식 표현(정리·저장)에 초점을 맞추며, RAG 시스템의 검색 단계에서 직접 활용되지 않아 지식을 정리해도 검색 품질 향상에 기여하지 못한다. 또한 NER/RE 기반 대규모 지식 그래프 구축에는 학습 데이터 수만 건과 상당한 레이블링 비용이 소요되어 소규모 프로젝트 적용이 어렵다.

**본 연구의 대응:** 경량 온톨로지(6개 개념 유형: crop, env, nutrient, disease, stage, practice)를 설계하고, 규칙 기반 패턴 매칭으로 검색 단계에서 직접 활용한다. 동의어/유의어 목록으로 커버리지를 확보하면서 구축 비용을 최소화한다.

## 2.5 인과관계 추출 (Causal Relation Extraction)

인과관계 추출(Causal Relation Extraction)은 텍스트에서 "A 때문에 B가 발생했다"와 같은 원인-결과 관계를 식별하는 NLP 태스크이다[14]. 농업 도메인에서는 WordNet과 식물 병해 정보를 활용한 동사 쌍 규칙 기반 연구가 정밀도 86.0%, 재현율 70.0%를 GPU 없이 달성하였다[15]. CaEXR(2024)은 단어 쌍 네트워크 기반 인과관계 공동 추출 프레임워크를 제안하였다[16].

**한계점:** 기존 인과관계 추출 연구는 한 문장 안에서의 관계 식별에 집중하여, "문서 A의 원인"과 "문서 B의 해결책"처럼 서로 다른 문서 간 인과관계 연결이 어렵다. 딥러닝 기반 방식(CaEXR 등)은 GPU가 필수라 8GB RAM 엣지 환경에서 실행이 불가능하다.

**본 연구의 대응:** 문서 단위로 인과관계 역할(cause/effect/solution)을 분류하고, 공통 키워드(작물, 환경요소, 병해)를 기반으로 문서 간 인과관계 그래프를 구축한다. 규칙 기반 패턴 매칭("원인", "때문", "관리", "해야" 등)으로 CPU만으로 실행 가능하다.

## 2.6 검색 다양성 (Diversity in Retrieval)

Carbonell & Goldstein(1998)의 **MMR(Maximal Marginal Relevance, 관련성 높은 문서 중 서로 내용이 다른 것만 선택하여 중복 없이 다양한 정보 제공)**는 관련성과 다양성의 균형을 조절하는 대표적 방법이다[18]. VRSD(2024)는 MMR 대비 90% 이상의 승률을 보이는 새로운 다양성 알고리즘을 제안하였다[19].

**한계점:** 기존 다양성 연구는 범용 검색에 초점을 맞추며, 농업 도메인에서 "와사비 질문에 상추 문서가 섞여 나오는" 문제나 동일 작물에 대한 비슷한 내용 중복 문제를 다루지 않는다. MMR의 다양성 조절 파라미터(λ)도 고정값을 사용하여 작물별 필터링 같은 도메인 특화 요구를 반영하지 못한다.

**본 연구의 대응:** 시맨틱 중복 제거(임베딩 코사인 유사도 85% 이상이면 같은 내용으로 판단하여 제거)와 작물 필터링(질문 작물과 일치하면 +0.5, 불일치하면 ×0.15)을 결합하여 도메인 특화 다양성을 확보한다.

## 2.7 엣지 AI 및 온디바이스 추론 (Edge AI and On-Device Inference)

### 2.7.1 엣지 LLM 배포

엣지 디바이스에서의 LLM 추론을 위한 모델 압축 기법들이 체계적으로 연구되고 있다[22]:
- **양자화(quantization)**: 모델 가중치의 정밀도를 낮춤(FP32→INT4) → 용량 75% 감소
- **지식 증류(knowledge distillation)**: 큰 모델(teacher)의 출력을 작은 모델(student)이 학습 → 적은 파라미터로 유사 성능
- **프루닝(pruning)**: 영향력 적은 가중치 제거 → 연산량 감소

**llama.cpp**는 GGUF 양자화 포맷을 활용하여 일반 CPU 및 저사양 GPU에서 LLM 추론을 가능하게 하며[23], Q4_K_M 양자화(4비트 정밀도)는 4B 파라미터(40억 개 가중치) 모델 기준 원본 대비 메모리 약 70% 절감을 달성한다(FP16 8GB → Q4 2.5GB).

### 2.7.2 EdgeRAG

**EdgeRAG**(2024)는 계층적 인덱싱(hierarchical indexing, 문서를 중요도/접근 빈도별로 계층화하여 필요한 것만 메모리에 로드)과 선택적 문서 로딩 전략으로 메모리 사용량을 50% 이상 감소시키면서 검색 품질을 유지하였다[24].

**한계점:** EdgeRAG는 범용 메모리 최적화에 초점을 맞추며, 도메인 특화 지식 구조를 활용하지 않는다. 단일 Dense 검색만 지원하여 "EC 2.5 dS/m" 같은 수치/단위 정보의 정확한 매칭이 어렵다.

### 2.7.3 경량 임베딩 모델

**Model2Vec**(2024)은 지식 증류(큰 임베딩 모델의 지식을 작은 모델로 전달)를 통해 256차원 정적 벡터로 100-400배 빠른 추론 속도와 15배 작은 모델 크기를 달성하나, 품질이 5-10% 하락하여 정밀 검색이 필요한 농업 질의에는 부정확할 수 있다[25]. **EmbeddingGemma**(2024)는 308M 파라미터(약 600MB)로 1B(10억) 파라미터 이상 모델과 유사한 검색 성능을 보인다[26].

### 2.7.4 스마트팜 엣지 컴퓨팅

Microsoft **FarmBeats**는 농업 IoT 센서 데이터 수집/전송 아키텍처를 제안하였고[27], 엣지 기반 스마트 농업 프레임워크(IoT 스트림 실시간 처리)[28], **Farm-LightSeek**(2024)의 경량 CNN 병해충 이미지 분류 프레임워크[29] 등이 연구되었다.

**한계점:** 기존 스마트팜 엣지 연구는 센서 수치 데이터 처리나 이미지 기반 병해충 탐지에 집중하며, "잎이 노랗게 변했는데 원인이 뭔가요?"와 같은 텍스트 질문-답변을 위한 RAG 기반 지식 검색과 LLM 추론의 엣지 배포는 다루지 않는다.

**본 연구의 대응:** llama.cpp Q4_K_M 양자화(메모리 75%↓), FAISS mmap(메모리 맵, 인덱스 전체를 RAM에 올리지 않고 필요한 부분만 로드), 메모리 적응형 리랭킹(가용 메모리에 따라 리랭커 자동 선택: 0.8GB 미만→비활성화, 0.8~1.5GB→경량, 1.5GB 이상→고품질)을 통해 RAG 시스템 전체의 엣지 배포를 지원한다.

## 2.8 RAG 평가 방법론 (RAG Evaluation Methods)

전통적인 RAG 평가는 Precision, Recall, MRR 등 IR 메트릭에 의존하며, 수동 레이블링된 Ground Truth(정답 문서)가 필수적이다. 그러나 Ground Truth 구축에는 도메인 전문가의 검증이 필요하여 비용이 높고, 합성 데이터의 source_ids 정확도 문제가 발생한다.

**RAGAS**(Es et al., 2024)는 LLM-as-Judge 기반 Reference-free 평가 프레임워크로, Ground Truth 없이 Faithfulness(답변 충실도), Answer Relevancy(답변 관련성), Context Precision(컨텍스트 정밀도)을 측정한다[38]. EACL 2024 Demo Track에서 발표되어 500회 이상 인용되었으며, RAG 평가의 de facto 표준으로 자리잡았다.

**ARES**(Saad-Falcon et al., 2024)는 Stanford에서 개발한 자동화 평가 시스템으로, 문서로부터 Synthetic QA를 자동 생성하고 Fine-tuned LLM Judges로 평가한다[39]. NAACL 2024 Long Paper로 발표되어 학술적 권위를 인정받았다. PPI(Prediction-Powered Inference)를 통해 소량의 human annotation(~150개)으로 신뢰구간을 제공한다.

**한계점:** 기존 RAG 평가 연구는 Ground Truth 의존성이 높아 소규모 도메인 특화 데이터셋에서 평가 품질 문제가 발생한다. LLM-as-Judge 방식도 LLM의 편향과 비용 문제가 존재한다.

**본 연구의 대응:** RAGAS 기반 Reference-free 평가를 도입하여 Ground Truth 품질 문제를 우회하고, 로컬 LLM(Qwen3-0.6B)을 활용하여 평가 비용을 최소화한다. IR 메트릭(MRR, NDCG)과 RAGAS 메트릭(Faithfulness, Answer Relevancy)을 병행하여 검색 품질과 생성 품질을 종합 평가한다.

## 2.9 연구 공백 및 본 연구의 기여

| 연구 영역 | 기존 연구의 한계 | 본 연구의 기여 |
|----------|-----------------|---------------|
| RAG | 클라우드 의존, 도메인 범용 | 엣지 배포, 농업 도메인 특화 |
| Hybrid Retrieval | 2채널, 고정 가중치 | 3채널 융합, 동적 가중치 |
| Graph RAG | LLM 기반 구축, 범용 관계 | 규칙 기반, 인과관계 명시화 |
| 농업 온톨로지 | 지식 표현 중심 | 검색 단계 직접 활용 |
| 인과관계 추출 | 문장 수준, 딥러닝 의존 | 문서 수준, 규칙 기반 |
| 엣지 RAG | 범용 메모리 최적화 | 도메인 특화 + 품질 향상 |
| **RAG 평가** | Ground Truth 의존, 고비용 | RAGAS Reference-free, 로컬 LLM |
