A detailed, high-fidelity technical architecture diagram of 'ERA-SmartFarm-RAG' based on a specific layout.
Style: Professional Engineering Diagram. Clean, High Contrast, White Background.
Layout: 3 Main Horizontal Sections (A, B, C) plus a Header and Footer.

**Header**: "Edge Device Environment (8GB RAM | Q4_K_M | Offline)"

**Section A: Knowledge Ingestion Pipeline (Top)**
- Flow: [Data Sources (Local/HF)] -> [Text Extraction (PDF/OCR)] -> [Embedding] -> [Index & Graph Build] -> [Knowledge Store]
- **Knowledge Store Box**: Contains [Dense Index], [Sparse Index], [Causal Graph], [Domain Ontology (6 types)].

**Cache Layer (Middle Bar)**
- [Query Cache] [Embedding Cache] [Response Cache]

**Section B: Hybrid Retrieval Pipeline (Middle)**
- Flow: [Query Analysis (Ontology/DAT)] -> [3-Channel Search (Dense/Sparse/PathRAG)] -> [Context Shaping (Crop/Dedup/Rerank)]

**Section C: Answer Generation Pipeline (Bottom)**
- Flow: [Prompt Builder] -> [LLM Engine (llama.cpp)] -> [Response]
- **Fallback**: Arrow from LLM Engine (failure) -> [Fallback Chain (Cache/Template/Search)].

**Footer**: "No Cloud Required | Full Pipeline On-Device | Data Never Leaves Device"

Visuals:
- Use distinct bounding boxes for Sections A, B, C.
- Use clear arrows (->) to show the flow within each section.
- Color Code: Section A (Sage Green), Section B (Slate Blue), Section C (Amber).
- Ensure text is legible and aligned.
